<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="th"
      th:fragment="layout(content)"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title th:text="${title} ?: 'NAILORA'">NAILORA</title>

  <!-- CSS -->
  <link rel="stylesheet" th:href="@{/css/app.css}" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Theme -->
  <style>
    :root {
      --pink-600: #d63384;
      --pink-300: #f7a7c5;
      --gray-100: #f8f9fa;
      --gray-700: #555;
    }

    body {
      font-family: "Prompt", sans-serif;
      background-color: #fff;
      color: #333;
    }

    /* ==== Public Header ==== */
    header.container {
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: .3rem;
      color: var(--pink-600);
    }

    .brand span {
      color: var(--pink-600);
    }

    nav a {
      font-weight: 500;
      color: var(--gray-700);
      transition: color .25s ease;
    }

    nav a:hover {
      color: var(--pink-600);
    }

    /* ==== Admin Header ==== */
    .brand-admin {
      font-weight: 800;
      font-size: clamp(20px, 3vw, 28px);
      letter-spacing: .5px;
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      padding: .25rem .6rem;
      border-radius: .75rem;
      background: linear-gradient(135deg, rgba(255,105,180,.15), rgba(255,255,255,.05));
      border: 1px solid rgba(255,105,180,.35);
      text-decoration: none !important;
    }

    .brand-admin .emoji {
      filter: drop-shadow(0 2px 6px rgba(255,105,180,.35));
      font-size: 1.25em;
      line-height: 1;
    }

    .nav-admin .nav-link {
      color: #fff !important;
      opacity: .9;
      font-weight: 500;
      transition: all .2s;
    }

    .nav-admin .nav-link:hover {
      opacity: 1;
      color: var(--pink-300) !important;
    }

    .logout-btn {
      border: 1px solid rgba(255,255,255,.35);
    }

    /* ==== Main Section ==== */
    main {
      min-height: 70vh;
      padding-top: 2rem;
      padding-bottom: 3rem;
    }

    /* ==== Footer ==== */
    footer {
      font-size: 0.9rem;
    }

    footer.container {
      color: #777;
    }

    footer.bg-light {
      color: #444;
    }

    /* ==== Optional Styling for Buttons ==== */
    .btn-pink {
      background-color: var(--pink-600);
      color: #fff;
      border: none;
      transition: background-color .25s ease;
    }

    .btn-pink:hover {
      background-color: #b62c71;
    }
  </style>
</head>

<body th:classappend="${#authorization.expression('hasRole(''ADMIN'')')} ? 'admin-mode' : 'user-mode'">

  <!-- ===== Public Header ===== -->
  <header sec:authorize="!hasRole('ADMIN')" class="container py-3 d-flex align-items-center justify-content-between">
    <a href="/" class="brand fs-4 fw-bold text-decoration-none">
      ðŸ’… <span>NAILORA</span>
    </a>
    <nav class="d-flex gap-4">
      <a class="text-decoration-none" href="/booking/services">Service</a>
      <a class="text-decoration-none" href="/my-bookings">Check Booking</a>
      <a class="text-decoration-none" href="/login">Admin</a>
    </nav>
  </header>

  <!-- ===== Admin Header ===== -->
  <header sec:authorize="hasRole('ADMIN')" class="p-3 bg-dark text-white shadow-sm">
    <div class="container d-flex flex-wrap justify-content-between align-items-center">
      <a th:href="@{/}" class="brand-admin text-white">
        <span class="emoji">ðŸ’…</span>
        <span>NAILORA Admin</span>
      </a>

      <nav class="nav nav-admin align-items-center">
        <a class="nav-link" th:href="@{/admin/services}">Services</a>
        <a class="nav-link" th:href="@{/admin/slots}">Time Slots</a>
        <a class="nav-link" th:href="@{/admin/reports}">Reports</a>
        <a class="nav-link" th:href="@{/admin/requests}">Requests</a>
        <a class="nav-link" th:href="@{/admin/bookings}">Bookings</a>
        <form th:action="@{/logout}" method="post" class="ms-2">
          <input type="hidden" th:if="${_csrf}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          <button type="submit" class="btn btn-sm btn-outline-light logout-btn">Log out</button>
        </form>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main th:classappend="${#authorization.expression('hasRole(''ADMIN'')')} ? 'container my-4' : 'container py-6'">
    <th:block th:replace="${content}"></th:block>
  </main>

  <!-- FOOTER -->
  <footer sec:authorize="!hasRole('ADMIN')" class="container text-center py-4 border-top mt-5 text-muted">
    Â© <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span> NAILORA
  </footer>

  <footer sec:authorize="hasRole('ADMIN')" class="bg-light text-center p-3 border-top mt-5">
    <small>Â© <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span> Nailora Admin System</small>
  </footer>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script th:src="@{/js/app.js}"></script>
</body>
</html>
